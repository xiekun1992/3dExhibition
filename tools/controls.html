<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>Controls</title>
</head>
<body>
	<script src="../libs/dat.gui.js"></script>
	<script>
	window.addEventListener('message', function(e){
		function applySettings(name, value){
			window.top.postMessage({fn: name, param: value}, location.origin);
		}
		if(e.origin === location.origin){
			var controls = e.data;
			var gui = new dat.GUI();
			gui.add(controls, 'enableShadow').onChange(function(){
				applySettings('changeShadow', controls.enableShadow);
			});
			gui.add(controls, 'ambientLight').onChange(function(){
				applySettings('changeAmLight', controls.ambientLight);
			});
			
			var spotLightGUI = gui.addFolder('spotLight');
			spotLightGUI.add(controls, 'spotLightEnable').onChange(function(){
				applySettings('changeSpotLight', controls.spotLightEnable);
			});
			spotLightGUI.add(controls, 'spotLightX', -30, 30).onChange(function(){
				applySettings('changeSpotLightPosition', {x: controls.spotLightX});
			});
			spotLightGUI.add(controls, 'spotLightY', -30, 30).onChange(function(){
				applySettings('changeSpotLightPosition', {y: controls.spotLightY});
			});
			spotLightGUI.add(controls, 'spotLightZ', -30, 30).onChange(function(){
				applySettings('changeSpotLightPosition', {z: controls.spotLightZ});
			});

			var directionalLightGUI = gui.addFolder('directionalLight');
			directionalLightGUI.add(controls, 'directionalLightEnable').onChange(function(){
				applySettings('changeDirectLight', controls.directionalLightEnable);
			});
			directionalLightGUI.add(controls, 'directionalLightX', -30, 30).onChange(function(){
				applySettings('changeDirectLightPosition', {x: controls.directionalLightX});
			});
			directionalLightGUI.add(controls, 'directionalLightY', -30, 30).onChange(function(){
				applySettings('changeDirectLightPosition', {y: controls.directionalLightY});
			});
			directionalLightGUI.add(controls, 'directionalLightZ', -30, 30).onChange(function(){
				applySettings('changeDirectLightPosition', {z: controls.directionalLightZ});
			});
		}
	});
	</script>
</body>
</html>